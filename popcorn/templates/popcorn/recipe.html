{% extends "popcorn/base.html" %}
{% load static %}
{% block title %}
    {{ recipe.name }}
{% endblock %}
{% block additional_js %}
    <script src="{% static 'popcorn/js/recipe.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="card margin-big ">
        <div class="card-body">
            <div class="col">
                <h2 class="card-title text-center">{{ recipe.name }}</h2>
                <a href=" {% url 'edit_recipe' recipe.slug %}">Edytuj</a>
                {% if recipe.author %}
                    <h4 class="text-center">Autor: {{ recipe.author }}</h4>
                {% else %}
                    <h4 class="text-center">Autor: Brak</h4>
                {% endif %}
                <h4 class="text-center">Czas wykonania: {{ recipe.preparation_time }} min</h4>
                <h4 class="text-center">Ilość porcji: {{ recipe.servings_count }}</h4>
                <h4 class="text-center">Trudność wykonania: {{ recipe.get_difficulty_display }}</h4>
                <!--TODO: Add scaling-->
                {% if recipe.icon %}
                    <img src="{{ recipe.icon.url }}">
                {% endif %}

                <!--TODO: Add ingredients -->
                <!--TODO: Add categories -->
                <!--TODO: Add voting-->
                {% if user.is_authenticated %}
                    {% if vote_status == 'up' %}
                        <a class="nav-link vote vote-up" id="recipe-vote-button-up" onclick="voteRecipe('up')">Like</a>
                        <a class="nav-link vote" id="recipe-vote-button-down" onclick="voteRecipe('down')">Unlike</a>
                    {% elif vote_status == 'down' %}
                        <a class="nav-link vote" id="recipe-vote-button-up" onclick="voteRecipe('up')">Like</a>
                        <a class="nav-link vote vote-down" id="recipe-vote-button-down" onclick="voteRecipe('down')">Unlike</a>
                    {% else %}
                        <a class="nav-link vote" id="recipe-vote-button-up" onclick="voteRecipe('up')">Like</a>
                        <a class="nav-link vote" id="recipe-vote-button-down" onclick="voteRecipe('down')">Unlike</a>
                    {% endif %}
                {% else %}
                    <h4>Chcesz głosować? <a href="{% url 'login' %}">Zaloguj się!</a></h4>
                {% endif %}
                <h4 class="text-center" id="recipe-vote-count">Głosy: {{ recipe.vote_score }}</h4>
                <h4 class="text-center"></h4>
                <!--TODO: Add food icon-->
                {{ recipe.content|safe }}
                <br></br>

                {% if user.is_authenticated %}
                    <form method="post" style="margin-top: 1.3em;">
                        {{ comment_form.as_p }}
                        {% csrf_token %}
                        <button type="submit" class="btn btn-primary btn-lg">Odpowiedz</button>
                    </form>
                {% else %}
                    <p>Zaloguj się aby mieć możliwość dodawania komentarzy.</p>
                {% endif %}

                <!--TODO: Add comments-->
                <ol>
                    {% for c in comments %}
                        {% if c.author %}
                            <a>Autor: {{ c.author }} </a>
                        {% else %}
                            <a>Autor: [Skasowany] </a>
                        {% endif %}
                        <br>
                        <a>{{ c.content|safe }} </a>
                        <hr>
                    {% endfor %}
                </ol>
                
            </div>
        </div>
    </div>
{% endblock %}
